<div mat-dialog-content>
  <div class="w-100 d-flex justify-content-between align-items-center">
    <span class="title">
      <span *ngIf="!data.objectiveId; else objectiveEditTitle"> Objective erfassen </span>
      <ng-template #objectiveEditTitle> Objective bearbeiten </ng-template>
    </span>
    <button data-test-id="closeDrawer" mat-dialog-close mat-icon-button>
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <form (ngSubmit)="onSubmit($event)" [formGroup]="objectiveForm" class="d-flex flex-column flex-wrap container p-0">
    <div class="d-flex flex-column gap-2 col-12">
      <label class="text-black" for="title">Titel</label>
      <mat-form-field appearance="outline">
        <textarea cdkFocusInitial formControlName="title" id="title" matInput placeholder="Objective Title"></textarea>
        <span *ngIf="isTouchedOrDirty('title')">
          <mat-error *ngFor="let errorKey of getErrorKeysOfFormField('title')">
            {{ errorMessages[errorKey.toUpperCase()] }}
          </mat-error>
        </span>
      </mat-form-field>
    </div>

    <div class="d-flex flex-column gap-2 col-12">
      <label class="text-black" for="title">Beschreibung (optional)</label>
      <mat-form-field appearance="outline">
        <textarea formControlName="description" matInput placeholder="Objective Beschreibung"></textarea>
        <span *ngIf="isTouchedOrDirty('description')">
          <mat-error *ngFor="let errorKey of getErrorKeysOfFormField('description')">
            {{ errorMessages[errorKey.toUpperCase()] }}
          </mat-error>
        </span>
      </mat-form-field>
    </div>

    <div class="row">
      <div class="d-flex flex-column gap-2 col-6">
        <label class="text-black" for="quarter">Quartal</label>
        <mat-form-field>
          <mat-select formControlName="quarter" id="quarter">
            <mat-option *ngFor="let quarter of quarters$ | async" [value]="quarter.id">
              {{ quarter.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="d-flex flex-column gap-2 col-6">
        <label class="text-black" for="relation">Bezug (optional)</label>
        <mat-form-field>
          <mat-select formControlName="relation" id="relation">
            <mat-option *ngFor="let team of teams$ | async" [value]="team.id">
              {{ team.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="d-flex flex-column gap-2 col-6">
        <label class="text-black" for="quarter">Team</label>
        <mat-form-field>
          <mat-select formControlName="team" id="team">
            <mat-option *ngFor="let team of teams$ | async" [value]="team.id">
              {{ team.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <mat-checkbox
        class="d-flex align-items-center col-5"
        color="primary"
        formControlName="createKeyresults"
        *ngIf="!data.objectiveId"
      >
        Key Results im Anschluss erfassen
      </mat-checkbox>
    </div>
    <div class="d-flex justify-content-between" mat-dialog-actions>
      <div class="d-flex gap-2 p-0">
        <button [disabled]="objectiveForm.invalid" color="primary" mat-flat-button type="submit" submitType="ONGOING">
          Speichern
        </button>
        <button
          *ngIf="!data.objectiveId"
          [disabled]="objectiveForm.invalid"
          color="dark"
          mat-stroked-button
          submitType="DRAFT"
          type="submit"
        >
          Als Draft speichern
        </button>
        <button color="primary" mat-button mat-dialog-close>Abbrechen</button>
      </div>
      <button color="primary" *ngIf="data.objectiveId" type="button" mat-button (click)="deleteObjective()">
        Objective LÃ¶schen
      </button>
    </div>
  </form>
</div>
